# 청년국 전자투표 시스템 - 할 일 목록

## ✅ 완료된 작업

### 기본 설정 및 인프라
- [x] Next.js 프로젝트 생성
- [x] Supabase 프로젝트 생성 및 연결
- [x] 환경 변수 설정 (.env.local)
- [x] Tailwind CSS 설정
- [x] TypeScript 설정

### 데이터베이스
- [x] Supabase 스키마 설계 (supabase-schema.sql)
- [x] 7개 테이블 생성
  - [x] admin_emails (관리자)
  - [x] system_config (시스템 설정)
  - [x] villages (마을)
  - [x] elections (투표)
  - [x] candidates (후보자)
  - [x] voter_codes (참여코드)
  - [x] votes (투표 기록)
- [x] RLS 정책 설정
- [x] 인덱스 최적화
- [x] admin_emails 읽기 권한 추가

### 인증 시스템
- [x] Google OAuth 설정 (Supabase + Google Cloud Console)
- [x] 관리자 로그인 페이지 (/admin)
- [x] Google 로그인 기능 구현
- [x] 관리자 권한 확인 함수 (checkAdminAccess)
- [x] 로그아웃 기능
- [x] 세션 관리 (middleware)

### 페이지 구조
- [x] 홈페이지 (/)
- [x] 투표 페이지 (/vote) - UI만
- [x] 관리자 로그인 (/admin)
- [x] 관리자 대시보드 (/admin/dashboard)
- [x] 마을 관리 페이지 (/admin/villages)

### 관리자 기능
- [x] 대시보드 통계 표시
  - [x] 전체 투표 수
  - [x] 활성 투표 수
  - [x] 참여코드 수
  - [x] 마을 수
- [x] 마을 CRUD
  - [x] 마을 목록 조회
  - [x] 마을 추가
  - [x] 마을 삭제

---

## 🚀 Phase 1: 핵심 투표 기능 (최우선)

### 1. 투표 생성 및 관리 ✅
- [x] `/admin/elections` - 투표 목록 페이지
  - [x] 투표 목록 조회 (진행중/종료/전체)
  - [x] 투표 상태별 필터링
  - [x] 투표 삭제 기능
  - [ ] 투표 검색 기능 (선택사항)

- [x] `/admin/elections/create` - 투표 생성 페이지
  - [x] 투표 제목 입력
  - [x] 투표 유형 선택 (총대 선출 / 임원 선출)
  - [x] 마을 선택 (총대 선출인 경우)
  - [x] 직책 입력 (임원 선출인 경우)
  - [x] 라운드 설정 (1차, 2차 등)
  - [x] 최대 선택 수 설정
  - [x] 후보자 입력 (동적 추가/삭제)
  - [x] 투표 생성 API 구현
  - [x] 폼 유효성 검사

- [x] `/admin/elections/[id]` - 투표 상세 페이지
  - [x] 투표 정보 표시
  - [x] 후보자 목록
  - [x] 투표 상태 변경 (대기 → 등록중 → 진행중 → 종료)
  - [x] 후보자 추가/삭제
  - [x] 빠른 작업 링크 (모니터링, 결과, 코드관리)

### 2. 참여코드 생성 및 관리 ✅
- [x] `/admin/codes` - 참여코드 관리 페이지
  - [x] 코드 목록 조회
  - [x] 사용/미사용 필터링
  - [x] 코드 검색
  - [x] 코드 삭제
  - [x] 통계 대시보드 (전체/사용됨/미사용)

- [x] 참여코드 생성 기능 (기본)
  - [x] 단순 생성 모드
    - [x] 코드 타입 선택 (총대/임원)
    - [x] 생성 개수 입력
    - [x] 접근 가능한 투표 선택
    - [x] 마을 선택 (총대 코드인 경우)
    - [x] 일괄 생성 (nanoid 사용)
  - [x] 생성된 코드 목록 테이블로 표시
  
- [ ] 코드 출력 기능 (향후 추가)
  - [ ] CSV 업로드 모드 (이름과 함께 생성)
  - [ ] QR 코드 생성 (qrcode.react)
  - [ ] PDF 출력 (jspdf)
  - [ ] 인쇄용 HTML 뷰

### 3. 실제 투표 기능 (투표자용) ✅

- [x] `/vote` - 참여코드 입력 페이지
  - [x] 참여코드 입력 폼
  - [x] 코드 유효성 검사
  - [x] 에러 처리 (잘못된 코드, 이미 사용된 코드)

- [x] `/vote/[code]` - 투표 진행 페이지
  - [x] 참여코드로 접근 가능한 투표 목록 조회
  - [x] 투표 선택
  - [x] 후보자 목록 표시
  - [x] 후보자 선택 UI
    - [x] 단일 선택 (max_selections = 1)
    - [x] 복수 선택 (max_selections > 1)
    - [x] 선택 개수 제한 표시
  - [x] 투표 제출
  - [x] 중복 투표 방지
  - [x] 투표 완료 후 코드 사용 처리
  - [x] 득표수 자동 증가 (RPC 함수)

- [x] `/vote/complete` - 투표 완료 페이지
  - [x] 완료 메시지
  - [x] 투표 요약 정보

---

## 📊 Phase 2: 모니터링 및 결과

### 4. 실시간 투표 현황 ✅
- [x] `/admin/elections/[id]/monitor` - 실시간 모니터링
  - [x] 투표율 표시 (사용된 코드 / 전체 코드)
  - [x] 후보자별 득표 수
  - [x] 자동 새로고침 (10초마다)
  - [x] 수동 새로고침 버튼
  - [x] 마지막 업데이트 시간 표시
  - [x] 실시간 득표 진행바
  - [x] 현재 1위 강조 표시
  - [x] 통계 카드 (전체 코드, 투표 완료, 미투표, 투표율, 총 투표 수)
  - [ ] 실시간 득표 차트 (recharts) - 선택사항
    - [ ] 막대 그래프
    - [ ] 파이 차트

### 5. 투표 결과 ✅
- [x] `/admin/elections/[id]/results` - 결과 페이지
  - [x] 최종 득표 결과
  - [x] 당선자 표시 (max_selections 기준)
  - [x] 투표율 통계
  - [x] 마을별 투표율 (대의원 선출인 경우)
  - [x] 결과 진행바
  - [x] 득표율 계산 및 표시
  - [x] 투표 정보 요약
  - [x] 통계 카드 (전체 코드, 투표 완료, 미투표, 투표율, 투표자 수, 총 투표 수)
  - [ ] PDF 결과 보고서 생성 (선택사항)
  - [ ] 결과 공유 기능 (선택사항)

- [ ] `/results/[electionId]` - 공개 결과 페이지 (선택사항)
  - [ ] 투표자도 볼 수 있는 결과 페이지
  - [ ] 간단한 통계
  - [ ] 당선자 발표

---

## 🎨 Phase 3: UI/UX 개선

### 6. 사용자 경험 개선
- [ ] 로딩 스피너 통일
- [ ] 에러 메시지 토스트/알림 시스템
- [ ] 확인 다이얼로그 컴포넌트화
- [ ] 폼 유효성 검사 메시지 개선
- [ ] 반응형 디자인 최적화 (모바일)
- [ ] 다크모드 지원 (선택사항)

### 7. 성능 최적화
- [ ] React Query로 데이터 캐싱
- [ ] 이미지 최적화
- [ ] 코드 스플리팅
- [ ] Lighthouse 점수 개선

---

## 🔧 Phase 4: 추가 기능 및 관리

### 8. 시스템 설정
- [ ] `/admin/settings` - 시스템 설정 페이지
  - [ ] 로고 업로드
  - [ ] 메인 색상 변경
  - [ ] 시스템 이름 변경
  - [ ] 관리자 이메일 추가/삭제

### 9. 투표 라운드 관리
- [ ] 다회차 투표 지원
  - [ ] 1차 투표 → 2차 투표 자동 생성
  - [ ] 이전 라운드 결과 기반 후보자 필터링
  - [ ] 라운드별 결과 비교


---

## 🐛 버그 수정 및 개선

### 현재 알려진 이슈
- [ ] useEffect 린트 경고 수정 (dashboard, villages 페이지)
- [ ] Markdown 파일 린트 경고 수정 (선택사항)
- [ ] middleware deprecation 경고 해결

### 테스트
- [ ] 관리자 로그인 플로우 테스트
- [ ] 투표 생성 플로우 테스트
- [ ] 참여코드 생성 플로우 테스트
- [ ] 실제 투표 플로우 테스트
- [ ] 에러 케이스 테스트

---

## 📱 Phase 5: 배포 및 운영

### 12. 배포 준비
- [ ] 프로덕션 환경 변수 설정
- [ ] Vercel 배포 설정
- [ ] 커스텀 도메인 연결
- [ ] HTTPS 설정
- [ ] 성능 모니터링 설정

### 13. 문서화
- [ ] README.md 작성
  - [ ] 프로젝트 소개
  - [ ] 설치 방법
  - [ ] 사용 방법
- [ ] API 문서 작성
- [ ] 관리자 매뉴얼 작성
- [ ] 투표자 가이드 작성

### 14. 운영
- [ ] 백업 전략 수립
- [ ] 모니터링 도구 설정
- [ ] 에러 추적 (Sentry 등)
- [ ] 사용자 피드백 수집

---

## 💡 선택적 기능 (여유가 있을 때)

- [ ] 투표 미리보기 기능
- [ ] 투표 복사 기능
- [ ] 참여코드 재사용 설정
- [ ] 투표 종료 시간 자동 설정
- [ ] 투표 결과 엑셀 내보내기
- [ ] 다국어 지원 (한국어/영어)
- [ ] 투표자 인증 강화 (SMS, 이메일 인증)
- [ ] 실시간 투표 현황 공개 설정
- [ ] 투표 템플릿 기능

---

## 📝 작업 시작 전 체크리스트

매 작업 시작 전:
- [x] `npm run dev` 서버 실행 확인
- [x] Supabase 연결 확인
- [ ] Git 브랜치 확인 (필요시)
- [ ] 이전 작업 커밋 (필요시)

---

## 📅 다음 작업 계획

### ✅ 완료: Phase 1.1 - 투표 생성 페이지

1. ✅ `/admin/elections` 투표 목록 페이지 생성
2. ✅ `/admin/elections/create` 투표 생성 페이지 생성
3. ✅ `/admin/elections/[id]` 투표 상세 페이지 생성
4. ✅ 투표 생성 폼 UI 구현
5. ✅ 후보자 동적 추가/삭제 기능
6. ✅ 투표 생성 API 연결
7. ✅ 폼 유효성 검사
8. ✅ 상태 관리 기능 (대기/등록중/진행중/종료)

**소요 시간**: 약 2시간

### ✅ 완료: Phase 1.2 - 참여코드 생성 및 관리 (기본)

1. ✅ `/admin/codes` 페이지 생성
2. ✅ 코드 목록 조회 및 필터링
3. ✅ 단순 생성 모드 구현
4. ✅ 코드 통계 대시보드
5. ✅ 검색 및 삭제 기능

**소요 시간**: 약 1.5시간

### ✅ 완료: Phase 1.3 - 실제 투표 기능

1. ✅ `/vote` 참여코드 입력 페이지 개선
2. ✅ `/vote/[code]` 투표 진행 페이지 구현
3. ✅ 코드 유효성 검사
4. ✅ 후보자 선택 UI (단일/복수 선택 지원)
5. ✅ 투표 제출 및 중복 방지
6. ✅ 투표 완료 페이지
7. ✅ 득표수 자동 증가 RPC 함수

**소요 시간**: 약 2시간

### 🎯 다음 작업: Phase 2.1 - 실시간 모니터링 및 결과 ✅ 완료!

1. ✅ `/admin/elections/[id]/monitor` 실시간 모니터링 페이지
2. ✅ 투표율 및 득표 현황 표시
3. ✅ `/admin/elections/[id]/results` 결과 페이지
4. ✅ 당선자 표시 및 통계

**소요 시간**: 약 1.5시간

### 🎯 다음 작업: Phase 3.1 - UI/UX 개선

1. 로딩 스피너 통일 및 컴포넌트화
2. 에러 메시지 토스트/알림 시스템
3. 확인 다이얼로그 컴포넌트
4. 반응형 디자인 최적화

**예상 소요 시간**: 2-3시간

---

## 🎯 현재 진행 상황

**완료율**: 약 80% (기본 인프라, 관리자 기능, 투표 관리, 참여코드 관리, 실제 투표 기능, 모니터링 및 결과)

**최근 완료**: Phase 2 - 실시간 모니터링 및 결과 페이지 ✅

**다음 마일스톤**: Phase 3 완료 (UI/UX 개선) → 90% 완료 예상

---

**마지막 업데이트**: 2025-11-05 - Phase 2 완료 (모니터링 및 결과 페이지)
